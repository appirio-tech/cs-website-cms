/**
 * DatePicker 1.0.0
 * 
 * A jQuery-based DatePicker that provides an easy way of creating both single
 * and multi-viewed calendars capable of accepting single, range, and multiple
 * selected dates.  Easily styled with two example styles provided: an attractive
 * 'dark' style, and a Google Analytics-like 'clean' style.
 * 
 * View project page for Examples and Documentation:
 * http://foxrunsoftware.github.com/DatePicker/
 * 
 * This project is distinct from and not affiliated with the jquery.ui.datepicker.
 * 
 * Copyright 2012, Justin Stern (www.foxrunsoftware.net)
 * Dual licensed under the MIT and GPL Version 2 licenses.
 * 
 * Based on Work by Original Author: Stefan Petre www.eyecon.ro
 * 
 * Depends:
 *   jquery.js
 */
(function(e){var t=function(){var t={},n={years:"datepickerViewYears",moths:"datepickerViewMonths",days:"datepickerViewDays"},r={wrapper:'<div class="datepicker"><div class="datepickerBorderT" /><div class="datepickerBorderB" /><div class="datepickerBorderL" /><div class="datepickerBorderR" /><div class="datepickerBorderTL" /><div class="datepickerBorderTR" /><div class="datepickerBorderBL" /><div class="datepickerBorderBR" /><div class="datepickerContainer"><table cellspacing="0" cellpadding="0"><tbody><tr></tr></tbody></table></div></div>',head:['<td class="datepickerBlock">','<table cellspacing="0" cellpadding="0">',"<thead>","<tr>",'<th colspan="7"><a class="datepickerGoPrev" href="#"><span><%=prev%></span></a>','<a class="datepickerMonth" href="#"><span></span></a>','<a class="datepickerGoNext" href="#"><span><%=next%></span></a></th>',"</tr>",'<tr class="datepickerDoW">',"<th><span><%=day1%></span></th>","<th><span><%=day2%></span></th>","<th><span><%=day3%></span></th>","<th><span><%=day4%></span></th>","<th><span><%=day5%></span></th>","<th><span><%=day6%></span></th>","<th><span><%=day7%></span></th>","</tr>","</thead>","</table></td>"],space:'<td class="datepickerSpace"><div></div></td>',days:['<tbody class="datepickerDays">',"<tr>",'<td class="<%=weeks[0].days[0].classname%>"><a href="#"><span><%=weeks[0].days[0].text%></span></a></td>','<td class="<%=weeks[0].days[1].classname%>"><a href="#"><span><%=weeks[0].days[1].text%></span></a></td>','<td class="<%=weeks[0].days[2].classname%>"><a href="#"><span><%=weeks[0].days[2].text%></span></a></td>','<td class="<%=weeks[0].days[3].classname%>"><a href="#"><span><%=weeks[0].days[3].text%></span></a></td>','<td class="<%=weeks[0].days[4].classname%>"><a href="#"><span><%=weeks[0].days[4].text%></span></a></td>','<td class="<%=weeks[0].days[5].classname%>"><a href="#"><span><%=weeks[0].days[5].text%></span></a></td>','<td class="<%=weeks[0].days[6].classname%>"><a href="#"><span><%=weeks[0].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[1].days[0].classname%>"><a href="#"><span><%=weeks[1].days[0].text%></span></a></td>','<td class="<%=weeks[1].days[1].classname%>"><a href="#"><span><%=weeks[1].days[1].text%></span></a></td>','<td class="<%=weeks[1].days[2].classname%>"><a href="#"><span><%=weeks[1].days[2].text%></span></a></td>','<td class="<%=weeks[1].days[3].classname%>"><a href="#"><span><%=weeks[1].days[3].text%></span></a></td>','<td class="<%=weeks[1].days[4].classname%>"><a href="#"><span><%=weeks[1].days[4].text%></span></a></td>','<td class="<%=weeks[1].days[5].classname%>"><a href="#"><span><%=weeks[1].days[5].text%></span></a></td>','<td class="<%=weeks[1].days[6].classname%>"><a href="#"><span><%=weeks[1].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[2].days[0].classname%>"><a href="#"><span><%=weeks[2].days[0].text%></span></a></td>','<td class="<%=weeks[2].days[1].classname%>"><a href="#"><span><%=weeks[2].days[1].text%></span></a></td>','<td class="<%=weeks[2].days[2].classname%>"><a href="#"><span><%=weeks[2].days[2].text%></span></a></td>','<td class="<%=weeks[2].days[3].classname%>"><a href="#"><span><%=weeks[2].days[3].text%></span></a></td>','<td class="<%=weeks[2].days[4].classname%>"><a href="#"><span><%=weeks[2].days[4].text%></span></a></td>','<td class="<%=weeks[2].days[5].classname%>"><a href="#"><span><%=weeks[2].days[5].text%></span></a></td>','<td class="<%=weeks[2].days[6].classname%>"><a href="#"><span><%=weeks[2].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[3].days[0].classname%>"><a href="#"><span><%=weeks[3].days[0].text%></span></a></td>','<td class="<%=weeks[3].days[1].classname%>"><a href="#"><span><%=weeks[3].days[1].text%></span></a></td>','<td class="<%=weeks[3].days[2].classname%>"><a href="#"><span><%=weeks[3].days[2].text%></span></a></td>','<td class="<%=weeks[3].days[3].classname%>"><a href="#"><span><%=weeks[3].days[3].text%></span></a></td>','<td class="<%=weeks[3].days[4].classname%>"><a href="#"><span><%=weeks[3].days[4].text%></span></a></td>','<td class="<%=weeks[3].days[5].classname%>"><a href="#"><span><%=weeks[3].days[5].text%></span></a></td>','<td class="<%=weeks[3].days[6].classname%>"><a href="#"><span><%=weeks[3].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[4].days[0].classname%>"><a href="#"><span><%=weeks[4].days[0].text%></span></a></td>','<td class="<%=weeks[4].days[1].classname%>"><a href="#"><span><%=weeks[4].days[1].text%></span></a></td>','<td class="<%=weeks[4].days[2].classname%>"><a href="#"><span><%=weeks[4].days[2].text%></span></a></td>','<td class="<%=weeks[4].days[3].classname%>"><a href="#"><span><%=weeks[4].days[3].text%></span></a></td>','<td class="<%=weeks[4].days[4].classname%>"><a href="#"><span><%=weeks[4].days[4].text%></span></a></td>','<td class="<%=weeks[4].days[5].classname%>"><a href="#"><span><%=weeks[4].days[5].text%></span></a></td>','<td class="<%=weeks[4].days[6].classname%>"><a href="#"><span><%=weeks[4].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[5].days[0].classname%>"><a href="#"><span><%=weeks[5].days[0].text%></span></a></td>','<td class="<%=weeks[5].days[1].classname%>"><a href="#"><span><%=weeks[5].days[1].text%></span></a></td>','<td class="<%=weeks[5].days[2].classname%>"><a href="#"><span><%=weeks[5].days[2].text%></span></a></td>','<td class="<%=weeks[5].days[3].classname%>"><a href="#"><span><%=weeks[5].days[3].text%></span></a></td>','<td class="<%=weeks[5].days[4].classname%>"><a href="#"><span><%=weeks[5].days[4].text%></span></a></td>','<td class="<%=weeks[5].days[5].classname%>"><a href="#"><span><%=weeks[5].days[5].text%></span></a></td>','<td class="<%=weeks[5].days[6].classname%>"><a href="#"><span><%=weeks[5].days[6].text%></span></a></td>',"</tr>","</tbody>"],months:['<tbody class="<%=className%>">',"<tr>",'<td colspan="2"><a href="#"><span><%=data[0]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[1]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[2]%></span></a></td>','<td colspan="1"><a href="#"><span><%=data[3]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[4]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[5]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[6]%></span></a></td>','<td colspan="1"><a href="#"><span><%=data[7]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[8]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[9]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[10]%></span></a></td>','<td colspan="1"><a href="#"><span><%=data[11]%></span></a></td>',"</tr>","</tbody>"]},i={date:null,current:null,inline:!1,mode:"single",calendars:1,starts:0,prev:"&#9664;",next:"&#9654;",view:"days",position:"bottom",showOn:"focus",onRenderCell:function(){return{}},onChange:function(){},onBeforeShow:function(){return!0},onAfterShow:function(){},onBeforeHide:function(){return!0},onAfterHide:function(){},locale:{daysMin:["S","M","T","W","T","F","S"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},extraHeight:!1,extraWidth:!1,lastSel:!1},s=function(t){var n=e(t).data("datepicker"),i=e(t),s=Math.floor(n.calendars/2),o,u,a,f,l=0,c,h,p,d,v;i.find("td>table tbody").remove();for(var m=0;m<n.calendars;m++){o=new Date(n.current),o.addMonths(-s+m),v=i.find("table").eq(m+1),m==0&&v.addClass("datepickerFirstView"),m==n.calendars-1&&v.addClass("datepickerLastView"),v.hasClass("datepickerViewDays")?a=o.getMonthName(!0)+", "+o.getFullYear():v.hasClass("datepickerViewMonths")?a=o.getFullYear():v.hasClass("datepickerViewYears")&&(a=o.getFullYear()-6+" - "+(o.getFullYear()+5)),v.find("thead tr:first th a:eq(1) span").text(a),a=o.getFullYear()-6,u={data:[],className:"datepickerYears"};for(var g=0;g<12;g++)u.data.push(a+g);d=tmpl(r.months.join(""),u),o.setDate(1),u={weeks:[],test:10},f=o.getMonth();var a=(o.getDay()-n.starts)%7;o.addDays(-(a+(a<0?7:0))),l=0;while(l<42){h=parseInt(l/7,10),p=l%7,u.weeks[h]||(u.weeks[h]={days:[]}),u.weeks[h].days[p]={text:o.getDate(),classname:[]};var y=new Date;y.getDate()==o.getDate()&&y.getMonth()==o.getMonth()&&y.getYear()==o.getYear()&&u.weeks[h].days[p].classname.push("datepickerToday"),o>y&&u.weeks[h].days[p].classname.push("datepickerFuture"),f!=o.getMonth()&&(u.weeks[h].days[p].classname.push("datepickerNotInMonth"),u.weeks[h].days[p].classname.push("datepickerDisabled")),o.getDay()==0&&u.weeks[h].days[p].classname.push("datepickerSunday"),o.getDay()==6&&u.weeks[h].days[p].classname.push("datepickerSaturday");var b=n.onRenderCell(t,o),w=o.valueOf();n.date&&(!e.isArray(n.date)||n.date.length>0)&&(b.selected||n.date==w||e.inArray(w,n.date)>-1||n.mode=="range"&&w>=n.date[0]&&w<=n.date[1])&&u.weeks[h].days[p].classname.push("datepickerSelected"),b.disabled&&u.weeks[h].days[p].classname.push("datepickerDisabled"),b.className&&u.weeks[h].days[p].classname.push(b.className),u.weeks[h].days[p].classname=u.weeks[h].days[p].classname.join(" "),l++,o.addDays(1)}d=tmpl(r.days.join(""),u)+d,u={data:n.locale.monthsShort,className:"datepickerMonths"},d=tmpl(r.months.join(""),u)+d,v.append(d)}},o=function(e){if(Date.prototype.tempDate)return;Date.prototype.tempDate=null,Date.prototype.months=e.months,Date.prototype.monthsShort=e.monthsShort,Date.prototype.getMonthName=function(e){return this[e?"months":"monthsShort"][this.getMonth()]},Date.prototype.addDays=function(e){this.setDate(this.getDate()+e),this.tempDate=this.getDate()},Date.prototype.addMonths=function(e){this.tempDate==null&&(this.tempDate=this.getDate()),this.setDate(1),this.setMonth(this.getMonth()+e),this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.addYears=function(e){this.tempDate==null&&(this.tempDate=this.getDate()),this.setDate(1),this.setFullYear(this.getFullYear()+e),this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.getMaxDays=function(){var e=new Date(Date.parse(this)),t=28,n;n=e.getMonth(),t=28;while(e.getMonth()==n)t++,e.setDate(t);return t-1}},u=function(t){var n=e(t).data("datepicker"),r=e("#"+n.id);if(n.extraHeight===!1){var i=e(t).find("div");n.extraHeight=i.get(0).offsetHeight+i.get(1).offsetHeight,n.extraWidth=i.get(2).offsetWidth+i.get(3).offsetWidth}var s=r.find("table:first").get(0),o=s.offsetWidth,u=s.offsetHeight;r.css({width:o+n.extraWidth+"px",height:u+n.extraHeight+"px"}).find("div.datepickerContainer").css({width:o+"px",height:u+"px"})},a=function(t){e(t.target).is("span")&&(t.target=t.target.parentNode);var n=e(t.target);if(n.is("a")){t.target.blur();if(n.hasClass("datepickerDisabled"))return!1;var r=e(this).data("datepicker"),i=n.parent(),o=i.parent().parent().parent(),u=e("table",this).index(o.get(0))-1,a=new Date(r.current),l=!1,c=!1,h=Math.floor(r.calendars/2);if(i.is("th"))n.hasClass("datepickerMonth")?(a.addMonths(u-h),r.mode=="range"?(r.date[0]=a.setHours(0,0,0,0).valueOf(),a.addDays(a.getMaxDays()-1),a.setHours(23,59,59,0),r.date[1]=a.valueOf(),c=!0,l=!0,r.lastSel=!1):r.calendars==1&&(o.eq(0).hasClass("datepickerViewDays")?(o.eq(0).toggleClass("datepickerViewDays datepickerViewMonths"),n.find("span").text(a.getFullYear())):o.eq(0).hasClass("datepickerViewMonths")?(o.eq(0).toggleClass("datepickerViewMonths datepickerViewYears"),n.find("span").text(a.getFullYear()-6+" - "+(a.getFullYear()+5))):o.eq(0).hasClass("datepickerViewYears")&&(o.eq(0).toggleClass("datepickerViewYears datepickerViewDays"),n.find("span").text(a.getMonthName(!0)+", "+a.getFullYear())))):i.parent().parent().is("thead")&&(o.eq(0).hasClass("datepickerViewDays")?r.current.addMonths(n.hasClass("datepickerGoPrev")?-1:1):o.eq(0).hasClass("datepickerViewMonths")?r.current.addYears(n.hasClass("datepickerGoPrev")?-1:1):o.eq(0).hasClass("datepickerViewYears")&&r.current.addYears(n.hasClass("datepickerGoPrev")?-12:12),c=!0);else if(i.is("td")&&!i.hasClass("datepickerDisabled")){if(o.eq(0).hasClass("datepickerViewMonths"))r.current.setMonth(o.find("tbody.datepickerMonths td").index(i)),r.current.setFullYear(parseInt(o.find("thead th a.datepickerMonth span").text(),10)),r.current.addMonths(h-u),o.eq(0).toggleClass("datepickerViewMonths datepickerViewDays");else if(o.eq(0).hasClass("datepickerViewYears"))r.current.setFullYear(parseInt(n.text(),10)),o.eq(0).toggleClass("datepickerViewYears datepickerViewMonths");else{var p=parseInt(n.text(),10);a.addMonths(u-h),i.hasClass("datepickerNotInMonth")&&a.addMonths(p>15?-1:1),a.setDate(p);switch(r.mode){case"multiple":p=a.setHours(0,0,0,0).valueOf(),e.inArray(p,r.date)>-1?e.each(r.date,function(e,t){if(t==p)return r.date.splice(e,1),!1}):r.date.push(p);break;case"range":r.lastSel||(r.date[0]=a.setHours(0,0,0,0).valueOf()),p=a.setHours(23,59,59,0).valueOf(),p<r.date[0]?(r.date[1]=r.date[0]+86399e3,r.date[0]=p-86399e3):r.date[1]=p,r.lastSel=!r.lastSel;break;default:r.date=a.valueOf()}l=!0}c=!0}c&&s(this),l&&r.onChange.apply(this,f(r))}return!1},f=function(t){var n=null;return t.mode=="single"?t.date&&(n=new Date(t.date)):(n=new Array,e(t.date).each(function(e,t){n.push(new Date(t))})),[n,t.el]},l=function(){var e=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(e?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(e?document.documentElement.clientHeight:document.body.clientHeight)}},c=function(e,t,n){if(e==t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(e.compareDocumentPosition(t)&16);var r=t.parentNode;while(r&&r!=n){if(r==e)return!0;r=r.parentNode}return!1},h=function(t){var n=e("#"+e(this).data("datepickerId"));if(!n.is(":visible")){var r=n.get(0),i=n.data("datepicker"),o=i.onBeforeShow.apply(this,[r]);if(i.onBeforeShow.apply(this,[r])==0)return;s(r);var a=e(this).offset(),f=l(),c=a.top,h=a.left,d=e.curCSS(r,"display");n.css({visibility:"hidden",display:"block"}),u(r);switch(i.position){case"top":c-=r.offsetHeight;break;case"left":h-=r.offsetWidth;break;case"right":h+=this.offsetWidth;break;case"bottom":c+=this.offsetHeight}c+r.offsetHeight>f.t+f.h&&(c=a.top-r.offsetHeight),c<f.t&&(c=a.top+this.offsetHeight+r.offsetHeight),h+r.offsetWidth>f.l+f.w&&(h=a.left-r.offsetWidth),h<f.l&&(h=a.left+this.offsetWidth),n.css({visibility:"visible",display:"block",top:c+"px",left:h+"px"}),i.onAfterShow.apply(this,[n.get(0)]),e(document).bind("mousedown",{cal:n,trigger:this},p)}return!1},p=function(t){t.target!=t.data.trigger&&!c(t.data.cal.get(0),t.target,t.data.cal.get(0))&&t.data.cal.data("datepicker").onBeforeHide.apply(this,[t.data.cal.get(0)])!=0&&(t.data.cal.hide(),t.data.cal.data("datepicker").onAfterHide.apply(this,[t.data.cal.get(0)]),e(document).unbind("mousedown",p))},d=function(t,n){t!="single"&&!n&&(n=[]);if(n&&(!e.isArray(n)||n.length>0))if(t!="single")if(!e.isArray(n))n=[(new Date(n)).setHours(0,0,0,0).valueOf()],t=="range"&&n.push((new Date(n[0])).setHours(23,59,59,0).valueOf());else{for(var r=0;r<n.length;r++)n[r]=(new Date(n[r])).setHours(0,0,0,0).valueOf();t=="range"&&(n.length==1&&n.push(new Date(n[0])),n[1]=(new Date(n[1])).setHours(23,59,59,0).valueOf())}else n=(new Date(n)).setHours(0,0,0,0).valueOf();return n};return{init:function(t){return t=e.extend({},i,t||{}),o(t.locale),t.calendars=Math.max(1,parseInt(t.calendars,10)||1),t.mode=/single|multiple|range/.test(t.mode)?t.mode:"single",this.each(function(){if(!e(this).data("datepicker")){t.el=this,t.date=d(t.mode,t.date),t.current?t.current=new Date(t.current):t.current=new Date,t.current.setDate(1),t.current.setHours(0,0,0,0);var i="datepicker_"+parseInt(Math.random()*1e3),o;t.id=i,e(this).data("datepickerId",t.id);var f=e(r.wrapper).attr("id",i).bind("click",a).data("datepicker",t);t.className&&f.addClass(t.className);var l="";for(var c=0;c<t.calendars;c++)o=t.starts,c>0&&(l+=r.space),l+=tmpl(r.head.join(""),{prev:t.prev,next:t.next,day1:t.locale.daysMin[o++%7],day2:t.locale.daysMin[o++%7],day3:t.locale.daysMin[o++%7],day4:t.locale.daysMin[o++%7],day5:t.locale.daysMin[o++%7],day6:t.locale.daysMin[o++%7],day7:t.locale.daysMin[o++%7]});f.find("tr:first").append(l).find("table").addClass(n[t.view]),s(f.get(0)),t.inline?(f.appendTo(this).show().css("position","relative"),u(f.get(0))):(f.appendTo(document.body),e(this).bind(t.showOn,h))}})},showPicker:function(){return this.each(function(){if(e(this).data("datepickerId")){var t=e("#"+e(this).data("datepickerId")),n=t.data("datepicker");n.inline||h.apply(this)}})},hidePicker:function(){return this.each(function(){if(e(this).data("datepickerId")){var t=e("#"+e(this).data("datepickerId")),n=t.data("datepicker");n.inline||e("#"+e(this).data("datepickerId")).hide()}})},setDate:function(t,n){return this.each(function(){if(e(this).data("datepickerId")){var r=e("#"+e(this).data("datepickerId")),i=r.data("datepicker");i.date=d(i.mode,t),n&&(i.current=new Date(i.mode!="single"?i.date[0]:i.date)),s(r.get(0))}})},getDate:function(){if(this.size()>0)return f(e("#"+e(this).data("datepickerId")).data("datepicker"))},clear:function(){return this.each(function(){if(e(this).data("datepickerId")){var t=e("#"+e(this).data("datepickerId")),n=t.data("datepicker");n.mode=="single"?n.date=null:n.date=[],s(t.get(0))}})},fixLayout:function(){return this.each(function(){if(e(this).data("datepickerId")){var t=e("#"+e(this).data("datepickerId")),n=t.data("datepicker");n.inline&&u(t.get(0))}})}}}();e.fn.extend({DatePicker:t.init,DatePickerHide:t.hidePicker,DatePickerShow:t.showPicker,DatePickerSetDate:t.setDate,DatePickerGetDate:t.getDate,DatePickerClear:t.clear,DatePickerLayout:t.fixLayout})})(jQuery),function(){var e={};this.tmpl=function t(n,r){var i=/\W/.test(n)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):e[n]=e[n]||t(document.getElementById(n).innerHTML);return r?i(r):i}}();